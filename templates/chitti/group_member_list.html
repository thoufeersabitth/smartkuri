{% extends "chitti/group_admin_base.html" %}
{% block title %}Member List{% endblock %}
{% load static %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'group_admin/css/member_list.css' %}">
{% endblock %}

{% block content %}
<div class="container">
    <h2>ðŸ‘¥ Member List</h2>

    <!-- ðŸ” SEARCH -->
    <form method="get">
        <input
            type="text"
            name="q"
            placeholder="Search name or phone..."
            value="{{ q|default:'' }}"
        >
        <button type="submit">Search</button>
    </form>

    <!-- MEMBER TABLE -->
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Phone</th>
                <th>Chitti Group</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {% for m in members %}
            <tr {% if m.status == 'defaulted' %} style="background:#fee2e2;" {% endif %}>
                <td data-label="Name">{{ m.name }}</td>
                <td data-label="Phone">{{ m.phone }}</td>
                <td data-label="Chitti Group">{{ m.assigned_chitti_group.name }}</td>
                <td data-label="Status">{{ m.get_status_display }}</td>
                <td data-label="Action">
                    <a href="{% url 'members:member_details' m.id %}" class="btn">Get Details</a>
                    <a href="{% url 'members:member_edit' m.id %}" class="btn btn-edit">Edit</a>
                    <a href="{% url 'members:member_delete' m.id %}" class="btn btn-delete" onclick="return confirm('Are you sure you want to delete this member?');">Delete</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="5" style="text-align:center; padding:15px;">
                    No members found
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- ðŸ“„ PAGINATION -->
    <div class="pagination">
        {% if members.has_previous %}
            <a href="?q={{ q }}&page=1">First</a>
            <a href="?q={{ q }}&page={{ members.previous_page_number }}">Previous</a>
        {% endif %}

        <span>Page {{ members.number }} of {{ members.paginator.num_pages }}</span>

        {% if members.has_next %}
            <a href="?q={{ q }}&page={{ members.next_page_number }}">Next</a>
            <a href="?q={{ q }}&page={{ members.paginator.num_pages }}">Last</a>
        {% endif %}
    </div>
</div>
{% endblock %}
